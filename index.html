<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Multi-Market Football Predictor Pro</title>
    <style>
        :root { --dark: #0f172a; --gold: #f59e0b; --green: #10b981; --red: #ef4444; --blue: #3b82f6; }
        body { font-family: 'Inter', sans-serif; background: #f1f5f9; margin: 0; padding: 20px; color: #1e293b; }
        .wrapper { max-width: 1200px; margin: auto; }
        .header { background: var(--dark); color: white; padding: 25px; border-radius: 12px; text-align: center; margin-bottom: 20px; border-bottom: 5px solid var(--gold); }
        .inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        textarea { width: 100%; height: 180px; border-radius: 8px; border: 2px solid #cbd5e1; padding: 12px; font-size: 11px; font-family: monospace; }
        .btn-calc { width: 100%; padding: 18px; background: var(--blue); color: white; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; font-size: 1.1rem; }
        .btn-calc:hover { background: #2563eb; }
        
        .market-grid { display: none; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-top: 30px; }
        .market-card { background: white; border-radius: 12px; padding: 20px; shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1); border-top: 4px solid var(--dark); }
        .market-card h3 { margin-top: 0; font-size: 1rem; border-bottom: 1px solid #e2e8f0; padding-bottom: 10px; display: flex; justify-content: space-between; }
        .row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #f8fafc; font-size: 0.9rem; }
        .prob-bar { height: 8px; background: #e2e8f0; border-radius: 4px; margin-top: 4px; overflow: hidden; }
        .fill { height: 100%; background: var(--blue); }
        .val { font-weight: bold; color: var(--dark); }
        .val-high { color: var(--green); }
        .tip { background: #fef3c7; padding: 10px; border-radius: 6px; font-size: 0.85rem; margin-top: 10px; font-weight: 500; }
    </style>
</head>
<body>

<div class="wrapper">
    <div class="header">
        <h1>SISTEMA DE AN√ÅLISIS MULTI-MERCADO</h1>
        <p>Procesamiento de Big Data para A-League y Ligas Internacionales</p>
    </div>

    <div class="inputs">
        <textarea id="rawL" placeholder="Pega estad√≠sticas LOCAL (Newcastle)"></textarea>
        <textarea id="rawV" placeholder="Pega estad√≠sticas VISITANTE (Macarthur)"></textarea>
    </div>
    <button class="btn-calc" onclick="calcularMercados()">ANALIZAR TODOS LOS MERCADOS</button>

    <div id="results" class="market-grid">
        <div class="market-card">
            <h3>Resultado Final (1X2) <span>üìä</span></h3>
            <div id="m-1x2"></div>
        </div>

        <div class="market-card">
            <h3>Goles (Over/Under) <span>‚öΩ</span></h3>
            <div id="m-goles"></div>
        </div>

        <div class="market-card">
            <h3>Ambos Anotan / Clean Sheet <span>üß§</span></h3>
            <div id="m-btts"></div>
        </div>

        <div class="market-card">
            <h3>C√≥rners Totales <span>üö©</span></h3>
            <div id="m-corners"></div>
        </div>

        <div class="market-card">
            <h3>Tiempos y Mitades <span>‚è±Ô∏è</span></h3>
            <div id="m-tiempos"></div>
        </div>

        <div class="market-card" style="border-top-color: var(--gold);">
            <h3>Bets de Valor / Funbets <span>üíé</span></h3>
            <div id="m-value"></div>
        </div>
    </div>
</div>

<script>
function get(t, r, p=false) {
    const m = t.match(r);
    if(!m) return 0;
    return p ? parseFloat(m[1])/100 : parseFloat(m[1]);
}

function row(label, val, barVal=0) {
    return `<div class="row"><span>${label}</span><span class="val">${val}</span></div>
            ${barVal > 0 ? `<div class="prob-bar"><div class="fill" style="width:${barVal}%"></div></div>` : ''}`;
}

function calcularMercados() {
    const l = document.getElementById('rawL').value;
    const v = document.getElementById('rawV').value;
    if(!l || !v) return;

    // Extracci√≥n masiva
    const D = {
        l_ppg: get(l, /PPG \(Home\):\s*([\d.]+)/),
        v_ppg: get(v, /PPG \(Away\):\s*([\d.]+)/),
        l_gf: get(l, /GF per match\s*([\d.]+)/),
        l_ga: get(l, /GA per match\s*([\d.]+)/),
        v_gf: get(v, /GF per match\s*([\d.]+)/),
        v_ga: get(v, /GA per match\s*([\d.]+)/),
        l_o25: get(l, /% over 2.5 goals\s*(\d+)%/, true),
        v_o25: get(v, /% over 2.5 goals\s*(\d+)%/, true),
        l_o15: get(l, /% over 1.5 goals\s*(\d+)%/, true),
        v_o15: get(v, /% over 1.5 goals\s*(\d+)%/, true),
        l_btts: get(l, /% both teams scored\s*(\d+)%/, true),
        v_btts: get(v, /% both teams scored\s*(\d+)%/, true),
        l_corn: get(l, /Corners For[\s\S]*?Home\s*([\d.]+)/),
        v_corn: get(v, /Corners For[\s\S]*?Away\s*([\d.]+)/),
        l_cornA: get(l, /Corners Against[\s\S]*?Home\s*([\d.]+)/),
        v_cornA: get(v, /Corners Against[\s\S]*?Away\s*([\d.]+)/),
        l_htWin: get(l, /Leading at HT\s*(\d+)/),
        l_015: get(l, /0-15\s*GF\s*(\d+)/),
        v_7590: get(v, /76-90\s*GF\s*\d+\s*GA\s*(\d+)/),
        l_scoredFirst: get(l, /% Team scored first\s*(\d+)%/, true),
        l_win2: get(l, /margin of 2 goals or more\s*\((\d+) wins\)/) || 0
    };

    document.getElementById('results').style.display = 'grid';

    // 1X2
    let pL = (D.l_ppg / (D.l_ppg + D.v_ppg + 0.4)) * 100;
    let pV = (D.v_ppg / (D.l_ppg + D.v_ppg + 0.4)) * 100;
    let pE = 100 - pL - pV;
    document.getElementById('m-1x2').innerHTML = row("Gana Local", pL.toFixed(1)+"%", pL) + row("Empate", pE.toFixed(1)+"%", pE) + row("Gana Visitante", pV.toFixed(1)+"%", pV);

    // GOLES
    let xG = ((D.l_gf + D.v_ga)/2) + ((D.v_gf + D.l_ga)/2);
    let pO25 = ((D.l_o25 + D.v_o25)/2) * 100;
    let pO15 = ((D.l_o15 + D.v_o15)/2) * 100;
    document.getElementById('m-goles').innerHTML = row("xG Total Proyectado", xG.toFixed(2)) + row("M√°s de 1.5 Goles", pO15.toFixed(1)+"%", pO15) + row("M√°s de 2.5 Goles", pO25.toFixed(1)+"%", pO25);

    // BTTS
    let pBTTS = ((D.l_btts + D.v_btts)/2) * 100;
    document.getElementById('m-btts').innerHTML = row("Ambos Anotan (S√≠)", pBTTS.toFixed(1)+"%", pBTTS) + row("Local Porter√≠a Cero", (100-(D.v_gf*40)).toFixed(1)+"%", 0);

    // CORNERS
    let cornTot = D.l_corn + D.v_corn;
    document.getElementById('m-corners').innerHTML = row("C√≥rners Local (Est.)", D.l_corn.toFixed(1)) + row("C√≥rners Visita (Est.)", D.v_corn.toFixed(1)) + row("C√≥rners Totales", cornTot.toFixed(1));

    // TIEMPOS
    document.getElementById('m-tiempos').innerHTML = row("Local gana 1ra Mitad", ((D.l_htWin/9)*100).toFixed(1)+"%") + row("Gol en primeros 15'", D.l_015 > 2 ? "MUY ALTO" : "MEDIO") + row("Local anota primero", (D.l_scoredFirst*100).toFixed(0)+"%");

    // VALUE
    let tip = (pO25 > 65 && pBTTS > 60) ? "Over 2.5 + BTTS" : "Doble Oportunidad Local";
    document.getElementById('m-value').innerHTML = `
        <div class="score-item">Marcador m√°s probable: <b>${Math.round((D.l_gf+D.v_ga)/2)} - ${Math.round((D.v_gf+D.l_ga)/2)}</b></div>
        <div class="tip">Sugerencia: ${tip}</div>
        <div class="tip" style="background:#dcfce7">Funbet: Gana Local por 2 o m√°s (Historial: ${D.l_win2} veces)</div>
    `;
}
</script>

</body>
</html>
