<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>XLS a JSON</title>
<style>
  body { font-family: Arial, sans-serif; background:#0d1117; color:#e6edf3; text-align:center; padding:40px; }
  input { margin:20px 0; }
  textarea { width:90%; height:400px; margin-top:20px; background:#161b22; color:#e6edf3; border:1px solid #30363d; padding:10px; font-family: monospace; }
</style>
</head>
<body>
  <h2>Convertir XLS/XLSX a JSON</h2>
  <input type="file" id="fileInput" accept=".xls,.xlsx" />
  <br>
  <textarea id="output" placeholder="Aquí aparecerá el JSON..."></textarea>

  <!-- Librería XLSX desde CDN -->
  <script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
  <script>
    document.getElementById('fileInput').addEventListener('change', function(e){
      const file = e.target.files[0];
      if(!file) return;

      const reader = new FileReader();
      reader.onload = function(e){
        const data = new Uint8Array(e.target.result);
        const workbook = XLSX.read(data, {type: 'array'});

        // Convierte cada hoja a JSON
        const result = {};
        workbook.SheetNames.forEach(sheetName => {
          const sheet = workbook.Sheets[sheetName];
          result[sheetName] = XLSX.utils.sheet_to_json(sheet, {defval:null});
        });

        document.getElementById('output').value = JSON.stringify(result, null, 2);
      };
      reader.readAsArrayBuffer(file);
    });
  </script>
</body>
</html>