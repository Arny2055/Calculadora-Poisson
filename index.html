<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pronosticador de Fútbol - Home vs Away</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background-color: #f4f7f6; color: #333; display: flex; justify-content: center; padding: 20px; }
        .container { background: white; padding: 30px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); width: 100%; max-width: 800px; }
        h1 { color: #2c3e50; text-align: center; }
        textarea { width: 100%; height: 150px; border: 2px solid #ddd; border-radius: 8px; padding: 10px; font-family: monospace; resize: vertical; margin-bottom: 20px; }
        button { background-color: #27ae60; color: white; border: none; padding: 12px 25px; border-radius: 6px; cursor: pointer; font-size: 16px; width: 100%; transition: background 0.3s; }
        button:hover { background-color: #219150; }
        #result { margin-top: 30px; display: none; }
        .match-card { display: flex; justify-content: space-around; align-items: center; background: #ecf0f1; padding: 20px; border-radius: 10px; text-align: center; }
        .team-box { flex: 1; }
        .score { font-size: 48px; font-weight: bold; color: #2c3e50; }
        .prediction-label { margin-top: 20px; font-weight: bold; color: #e67e22; text-align: center; font-size: 1.2em; }
        .stats-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 15px; font-size: 0.9em; }
    </style>
</head>
<body>

<div class="container">
    <h1>⚽ Pronosticador Pro</h1>
    <p>Pega aquí la tabla de estadísticas (Home vs Away):</p>
    <textarea id="rawData" placeholder="Al Sailiya    Al Rayyan&#10;(home matches)    (away matches)&#10;4    Played    7&#10;Goals For per match&#10;1.50    2.43..."></textarea>
    
    <button onclick="processData()">Analizar y Pronosticar</button>

    <div id="result">
        <div class="match-card">
            <div class="team-box">
                <h2 id="homeName">-</h2>
                <div class="score" id="homeScore">0</div>
                <p>Local</p>
            </div>
            <div style="font-size: 24px; font-weight: bold;">VS</div>
            <div class="team-box">
                <h2 id="awayName">-</h2>
                <div class="score" id="awayScore">0</div>
                <p>Visitante</p>
            </div>
        </div>
        <div class="prediction-label" id="predictionText"></div>
        <div class="stats-grid" id="statsDetails"></div>
    </div>
</div>

<script>
function processData() {
    const text = document.getElementById('rawData').value;
    const lines = text.split('\n').map(l => l.trim()).filter(l => l !== "");
    
    try {
        // Extraer nombres (Asumiendo que la primera línea tiene los nombres)
        const teamNames = lines[0].split(/\t|\s{2,}/);
        const homeName = teamNames[0] || "Local";
        const awayName = teamNames[1] || "Visitante";

        // Función para buscar valores numéricos en el texto
        const getValue = (keyword) => {
            const index = lines.findIndex(l => l.toLowerCase().includes(keyword.toLowerCase()));
            if (index === -1) return [0, 0];
            const values = lines[index + 1].split(/\t|\s{2,}/).map(v => parseFloat(v.replace('%', '')));
            return values;
        };

        // Extraer métricas clave
        const goalsPerMatch = getValue("Goals For per match");
        const cleanSheets = getValue("Clean sheets");
        const scoringRate = getValue("Scoring rate");
        const goalsAgainst = getValue("Goals Against per match");

        // --- ALGORITMO DE PREDICCIÓN ---
        // 1. Base de goles (Promedio de goles marcados por uno y recibidos por el otro)
        let homeExp = (goalsPerMatch[0] + goalsAgainst[1]) / 2;
        let awayExp = (goalsPerMatch[1] + goalsAgainst[0]) / 2;

        // 2. Ajuste por "Clean Sheets" (Defensa)
        homeExp -= (cleanSheets[1] / 100) * 0.5;
        awayExp -= (cleanSheets[0] / 100) * 0.5;

        // 3. Ajuste por capacidad de anotar
        if (scoringRate[0] > 80) homeExp += 0.2;
        if (scoringRate[1] > 80) awayExp += 0.2;

        // Redondear a resultados realistas
        const finalHome = Math.max(0, Math.round(homeExp));
        const finalAway = Math.max(0, Math.round(awayExp));

        // Mostrar resultados
        document.getElementById('homeName').innerText = homeName;
        document.getElementById('awayName').innerText = awayName;
        document.getElementById('homeScore').innerText = finalHome;
        document.getElementById('awayScore').innerText = finalAway;

        // Lógica de recomendación
        let recommendation = "";
        if (finalHome > finalAway) recommendation = `Pronóstico: Gana ${homeName}`;
        else if (finalAway > finalHome) recommendation = `Pronóstico: Gana ${awayName}`;
        else recommendation = "Pronóstico: Empate Clave";

        if ((finalHome + finalAway) >= 2.5) recommendation += " | Sugerencia: +2.5 Goles";
        else recommendation += " | Sugerencia: -2.5 Goles";

        document.getElementById('predictionText').innerText = recommendation;
        document.getElementById('result').style.display = 'block';

    } catch (e) {
        alert("Error al procesar los datos. Asegúrate de copiar la tabla completa.");
        console.error(e);
    }
}
</script>

</body>
</html>
