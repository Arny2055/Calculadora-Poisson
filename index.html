<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Backtesting por Equipo</title>
</head>
<body>
  <h1>Backtesting por Equipo</h1>
  <select id="teamSelect"></select>
  <button id="loadBtn">Cargar Datos</button>
  <pre id="results"></pre>

  <script>
  const sheetCSV = 'https://docs.google.com/spreadsheets/d/1CzPFSrL1EQiNMQ-PG0L2G6IW2JE2x67C/export?format=csv';

  async function loadSheet() {
    const res = await fetch(sheetCSV);
    const text = await res.text();
    const rows = text.split('\\n').map(r => r.split(','));
    return rows;
  }

  function populateTeams(rows) {
    const select = document.getElementById('teamSelect');
    const teams = [...new Set(rows.slice(1).map(r => r[?] ))]; // Reemplaza [?] con el índice de tu columna "Match Home" o similar.
    teams.forEach(team => {
      const opt = document.createElement('option');
      opt.value = team;
      opt.textContent = team;
      select.append(opt);
    });
  }

  function filterByTeam(rows, team) {
    return rows.slice(1).filter(r =>
      r[?] === team || r[?] === team // Reemplaza ambos índices con tus columnas de Home y Away.
    );
  }

  function showResults(matches) {
    const out = matches.map(r => r.join(' | ')).join('\\n');
    document.getElementById('results').textContent = out;
  }

  document.getElementById('loadBtn').addEventListener('click', async () => {
    const rows = await loadSheet();
    if (!document.getElementById('teamSelect').options.length) {
      populateTeams(rows);
    }
    const team = document.getElementById('teamSelect').value;
    const filtered = filterByTeam(rows, team);
    showResults(filtered);
  });
  </script>
</body>
</html>