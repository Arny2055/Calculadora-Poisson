<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pronosticador SoccerStats Pro</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 p-5">
    <div class="max-w-4xl mx-auto bg-white p-8 rounded-xl shadow-lg">
        <h1 class="text-3xl font-bold text-center mb-6 text-blue-600">⚽ Pronosticador de Resultados</h1>
        
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-8">
            <div class="p-4 border rounded bg-gray-50">
                <h2 class="font-bold mb-3 border-b">Datos Liga (Promedios)</h2>
                <label class="block text-sm">Goles Local Promedio</label>
                <input type="number" id="avg_home" value="1.50" step="0.01" class="w-full p-2 border rounded">
                <label class="block text-sm mt-2">Goles Visita Promedio</label>
                <input type="number" id="avg_away" value="1.20" step="0.01" class="w-full p-2 border rounded">
            </div>

            <div class="p-4 border rounded bg-blue-50">
                <h2 class="font-bold mb-3 border-b text-blue-700">Equipo Local</h2>
                <label class="block text-sm">Goles Marcados (Casa)</label>
                <input type="number" id="home_scored" value="2.1" step="0.1" class="w-full p-2 border rounded">
                <label class="block text-sm mt-2">Goles Recibidos (Casa)</label>
                <input type="number" id="home_conceded" value="0.9" step="0.1" class="w-full p-2 border rounded">
            </div>

            <div class="p-4 border rounded bg-red-50">
                <h2 class="font-bold mb-3 border-b text-red-700">Equipo Visitante</h2>
                <label class="block text-sm">Goles Marcados (Fuera)</label>
                <input type="number" id="away_scored" value="1.4" step="0.1" class="w-full p-2 border rounded">
                <label class="block text-sm mt-2">Goles Recibidos (Fuera)</label>
                <input type="number" id="away_conceded" value="1.8" step="0.1" class="w-full p-2 border rounded">
            </div>
        </div>

        <button onclick="calcular()" class="w-full bg-blue-600 text-white font-bold py-3 rounded-lg hover:bg-blue-700 transition">Calcular Pronóstico</button>

        <div id="resultados" class="mt-8 hidden">
            <h2 class="text-2xl font-bold mb-4 text-center">Probabilidades</h2>
            <div class="grid grid-cols-3 gap-4 text-center">
                <div class="p-4 bg-green-100 rounded">
                    <p class="text-sm">Victoria Local</p>
                    <p id="prob_1" class="text-2xl font-bold">--</p>
                </div>
                <div class="p-4 bg-yellow-100 rounded">
                    <p class="text-sm">Empate</p>
                    <p id="prob_x" class="text-2xl font-bold">--</p>
                </div>
                <div class="p-4 bg-red-100 rounded">
                    <p class="text-sm">Victoria Visita</p>
                    <p id="prob_2" class="text-2xl font-bold">--</p>
                </div>
            </div>
            <div class="mt-6 p-4 border rounded bg-gray-50 text-center">
                <p class="font-bold">Marcador Exacto más probable: <span id="exact_score" class="text-blue-600">--</span></p>
            </div>
        </div>
    </div>

    <script>
        function factorial(n) {
            return n <= 1 ? 1 : n * factorial(n - 1);
        }

        function poisson(k, lambda) {
            return (Math.exp(-lambda) * Math.pow(lambda, k)) / factorial(k);
        }

        function calcular() {
            const avgHome = parseFloat(document.getElementById('avg_home').value);
            const avgAway = parseFloat(document.getElementById('avg_away').value);
            
            // Fuerza de los equipos
            const homeAttack = parseFloat(document.getElementById('home_scored').value) / avgHome;
            const homeDefense = parseFloat(document.getElementById('home_conceded').value) / avgAway;
            const awayAttack = parseFloat(document.getElementById('away_scored').value) / avgAway;
            const awayDefense = parseFloat(document.getElementById('away_conceded').value) / avgHome;

            // Goles esperados (Lambda)
            const lambdaHome = homeAttack * awayDefense * avgHome;
            const lambdaAway = awayAttack * homeDefense * avgAway;

            let prob1 = 0, probX = 0, prob2 = 0;
            let maxProb = 0;
            let bestScore = "";

            for (let h = 0; h <= 5; h++) {
                for (let a = 0; a <= 5; a++) {
                    let pHome = poisson(h, lambdaHome);
                    let pAway = poisson(a, lambdaAway);
                    let pFinal = pHome * pAway;

                    if (h > a) prob1 += pFinal;
                    else if (h === a) probX += pFinal;
                    else prob2 += pFinal;

                    if (pFinal > maxProb) {
                        maxProb = pFinal;
                        bestScore = `${h} - ${a}`;
                    }
                }
            }

            document.getElementById('prob_1').innerText = (prob1 * 100).toFixed(1) + "%";
            document.getElementById('prob_x').innerText = (probX * 100).toFixed(1) + "%";
            document.getElementById('prob_2').innerText = (prob2 * 100).toFixed(1) + "%";
            document.getElementById('exact_score').innerText = bestScore;
            document.getElementById('resultados').classList.remove('hidden');
        }
    </script>
</body>
</html>
