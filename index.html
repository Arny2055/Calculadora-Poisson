<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herramienta de Diagn√≥stico El√©ctrico Industrial | Ley de Ohm</title>
    <style>
        /* Estilos Industriales */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 20px;
            background-color: #1c2630; /* Fondo Oscuro (Industrial) */
            color: #f0f0f0; 
        }
        .container { 
            max-width: 700px; 
            margin: auto; 
            background: #2b3947; /* Contenedor Principal */
            padding: 30px; 
            border-radius: 6px; 
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.4); 
            border-top: 5px solid #00aaff; /* L√≠nea de color industrial */
        }
        h1 { 
            color: #00aaff; 
            text-align: center; 
            border-bottom: 2px solid #444;
            padding-bottom: 10px;
            margin-bottom: 20px;
        }
        p { color: #ccc; }
        
        /* Estilos de Entrada de Datos */
        .input-group { 
            margin-bottom: 12px; 
            display: flex; 
            align-items: center; 
            background: #3a4753;
            padding: 8px 15px;
            border-radius: 4px;
        }
        .input-group label { 
            flex: 1; 
            margin-right: 15px; 
            font-weight: bold; 
            color: #fff;
        }
        .input-group input, .input-group select { 
            flex: 2; 
            padding: 10px; 
            border: 1px solid #00aaff; 
            border-radius: 4px; 
            background: #1c2630;
            color: #f0f0f0;
            font-size: 16px;
        }
        .input-group select { appearance: none; } /* Mejor est√©tica en select */
        
        /* Estilos del Bot√≥n */
        button { 
            width: 100%;
            padding: 12px 20px; 
            background-color: #00aaff; 
            color: #1c2630; 
            border: none; 
            border-radius: 4px; 
            cursor: pointer; 
            font-size: 18px;
            font-weight: bold;
            transition: background-color 0.3s, transform 0.1s; 
            margin-top: 20px;
        }
        button:hover { background-color: #0088cc; }
        button:active { transform: scale(0.99); }
        
        /* Estilos de la Secci√≥n de Resultados */
        .resultado, .diagnostico { 
            margin-top: 20px; 
            padding: 15px; 
            border-radius: 4px; 
            font-size: 1.1em;
        }
        .resultado { 
            border: 1px solid #00aaff; 
            background-color: #3a4753; 
        }
        .resultado strong { color: #00aaff; }
        
        /* Estilos de Diagn√≥stico con c√≥digos de color de mantenimiento */
        .diagnostico { 
            font-weight: bold; 
            border-left: 5px solid;
            padding-left: 15px;
        }
        
        .alerta-normal { 
            background-color: #14492d; /* Verde Oscuro */
            color: #90ee90; 
            border-color: #3cb371; /* Aceptable */
        }
        .alerta-alto { 
            background-color: #660000; /* Rojo Oscuro */
            color: #ffcccc; 
            border-color: #cc0000; /* Alarma/Cr√≠tico */
        }
        .alerta-bajo { 
            background-color: #664f00; /* Naranja/√Åmbar Oscuro */
            color: #ffdb80; 
            border-color: #ff9900; /* Precauci√≥n/Advertencia */
        }
        .alerta-error { 
            background-color: #4a148c; /* P√∫rpura */
            color: #e1bee7; 
            border-color: #9c27b0; /* Error de Entrada */
        }

        .sugerencia {
            display: block;
            margin-top: 10px;
            padding-top: 5px;
            border-top: 1px dashed #555;
            font-weight: normal;
            font-size: 0.9em;
            color: #ccc;
        }
    </style>
</head>
<body>

    <div class="container">
        <h1>üõ†Ô∏è Diagn√≥stico El√©ctrico de Cargas | Ley de Ohm</h1>
        <p>Utilice esta herramienta para comparar el rendimiento real (medido) de un circuito con su valor nominal (esperado).</p>

        <div class="input-group">
            <label for="variable-medida">Par√°metro Bajo An√°lisis:</label>
            <select id="variable-medida">
                <option value="I">Corriente (I) - Falla en Flujo</option>
                <option value="R">Resistencia (R) - Falla en Carga/Cableado</option>
                <option value="V">Voltaje (V) - Falla en Alimentaci√≥n</option>
            </select>
        </div>

        <hr style="border-color: #444; margin: 20px 0;">

        <h3>Valores Nominales (Base de Referencia)</h3>
        <div class="input-group" id="group-v-nominal">
            <label for="v-nominal">Voltaje Nominal (V):</label>
            <input type="number" id="v-nominal" placeholder="Ej: 480" title="Voltaje de alimentaci√≥n esperado.">
        </div>
        <div class="input-group" id="group-i-nominal" style="display: none;">
            <label for="i-nominal">Corriente Nominal (I):</label>
            <input type="number" id="i-nominal" placeholder="Ej: 15" title="Corriente de dise√±o esperada.">
        </div>
        <div class="input-group" id="group-r-nominal">
            <label for="r-nominal">Resistencia Nominal (R):</label>
            <input type="number" id="r-nominal" placeholder="Ej: 32" title="Impedancia u Ohmiaje esperado de la carga.">
        </div>

        <hr style="border-color: #444; margin: 20px 0;">
        <h3>Valor Medido (Lectura en Sitio)</h3>
        <div class="input-group">
            <label for="valor-real"><span id="label-real">Corriente Real (I) [A]</span>:</label>
            <input type="number" id="valor-real" placeholder="Valor le√≠do con el instrumento" title="Valor real medido en el circuito operativo.">
        </div>

        <button onclick="realizarDiagnostico()">‚úÖ Analizar y Diagnosticar Falla</button>

        <hr style="border-color: #444; margin: 20px 0;">
        <h3>Resultados del An√°lisis</h3>
        <div class="resultado">
            <p><strong>Valor Calculado / Esperado (<span id="unidad-esperada">I</span>):</strong> <span id="resultado-esperado">---</span></p>
        </div>
        <div class="diagnostico" id="area-diagnostico">
            <p><strong>Estado del Equipo:</strong> <span id="mensaje-diagnostico">Pendiente de An√°lisis</span></p>
            <span class="sugerencia" id="sugerencia-diagnostico">Ingrese los valores y presione "Analizar y Diagnosticar Falla".</span>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const selector = document.getElementById('variable-medida');
            selector.addEventListener('change', actualizarCampos);
            actualizarCampos(); 
        });

        // ====================================================================
        // L√ìGICA DE INTERFAZ (JS)
        // ====================================================================

        function actualizarCampos() {
            const variable = document.getElementById('variable-medida').value;
            
            // Mostrar/Ocultar campos nominales
            document.getElementById('group-v-nominal').style.display = 'flex'; 
            document.getElementById('group-i-nominal').style.display = 'none';
            document.getElementById('group-r-nominal').style.display = 'none';

            // Ajusta la visibilidad y etiqueta
            switch (variable) {
                case 'I': // I = V / R. Necesita V y R nominales.
                    document.getElementById('group-r-nominal').style.display = 'flex';
                    document.getElementById('label-real').textContent = 'Corriente Real (I) [A]:';
                    document.getElementById('unidad-esperada').textContent = 'I (Amperios)';
                    break;
                case 'R': // R = V / I. Necesita V e I nominales.
                    document.getElementById('group-i-nominal').style.display = 'flex';
                    document.getElementById('label-real').textContent = 'Resistencia Real (R) [Œ©]:';
                    document.getElementById('unidad-esperada').textContent = 'R (Ohmios)';
                    break;
                case 'V': // V = I * R. Necesita I y R nominales.
                    document.getElementById('group-i-nominal').style.display = 'flex';
                    document.getElementById('group-r-nominal').style.display = 'flex';
                    document.getElementById('label-real').textContent = 'Voltaje Real (V) [V]:';
                    document.getElementById('unidad-esperada').textContent = 'V (Voltios)';
                    break;
            }
            
            // Limpiar resultados
            document.getElementById('resultado-esperado').textContent = '---';
            document.getElementById('area-diagnostico').className = 'diagnostico';
            document.getElementById('mensaje-diagnostico').textContent = 'Pendiente de An√°lisis';
            document.getElementById('sugerencia-diagnostico').textContent = 'Ingrese los valores y presione "Analizar y Diagnosticar Falla".';
        }

        // ====================================================================
        // L√ìGICA DE DIAGN√ìSTICO (JS)
        // ====================================================================

        function realizarDiagnostico() {
            const variable = document.getElementById('variable-medida').value;
            
            let vNominal = parseFloat(document.getElementById('v-nominal').value) || 0;
            let iNominal = parseFloat(document.getElementById('i-nominal').value) || 0;
            let rNominal = parseFloat(document.getElementById('r-nominal').value) || 0;
            let valorReal = parseFloat(document.getElementById('valor-real').value) || 0;

            let valorEsperado;
            let mensaje = '';
            let sugerencia = '';
            let claseDiagnostico = 'alerta-normal'; 
            const tolerancia = 0.05; // 5% est√°ndar de tolerancia industrial
            const resultadoEsperadoElement = document.getElementById('resultado-esperado');
            const areaDiagnosticoElement = document.getElementById('area-diagnostico');
            const mensajeDiagnosticoElement = document.getElementById('mensaje-diagnostico');
            const sugerenciaDiagnosticoElement = document.getElementById('sugerencia-diagnostico');


            // 1. Validar entradas REALES
            if (valorReal <= 0) {
                claseDiagnostico = 'alerta-error';
                mensaje = 'ERROR: Lectura Real No V√°lida.';
                sugerencia = 'El valor medido debe ser positivo y mayor a cero. Verifique el instrumento y la medici√≥n.';
                resultadoEsperadoElement.textContent = 'N/A';
                areaDiagnosticoElement.className = `diagnostico ${claseDiagnostico}`;
                mensajeDiagnosticoElement.textContent = mensaje;
                sugerenciaDiagnosticoElement.textContent = sugerencia;
                return;
            }
            
            // 2. C√°lculo del Valor Esperado y Validaci√≥n de entradas NOMINALES
            try {
                if (variable === 'I') { // I = V / R
                    if (vNominal <= 0 || rNominal <= 0) throw new Error("V Nominal y R Nominal son requeridos y deben ser > 0.");
                    valorEsperado = vNominal / rNominal;
                } else if (variable === 'R') { // R = V / I
                    if (vNominal <= 0 || iNominal <= 0) throw new Error("V Nominal e I Nominal son requeridos y deben ser > 0.");
                    valorEsperado = vNominal / iNominal;
                } else if (variable === 'V') { // V = I * R
                    if (iNominal <= 0 || rNominal <= 0) throw new Error("I Nominal y R Nominal son requeridos y deben ser > 0.");
                    valorEsperado = iNominal * rNominal;
                }
            } catch (e) {
                claseDiagnostico = 'alerta-error';
                mensaje = 'ERROR: Datos de Referencia Incompletos.';
                sugerencia = e.message;
                resultadoEsperadoElement.textContent = 'N/A';
                areaDiagnosticoElement.className = `diagnostico ${claseDiagnostico}`;
                mensajeDiagnosticoElement.textContent = mensaje;
                sugerenciaDiagnosticoElement.textContent = sugerencia;
                return;
            }
            
            // 3. Diagn√≥stico (Comparaci√≥n Real vs. Esperado)
            if (valorEsperado === 0) {
                 claseDiagnostico = 'alerta-error';
                 mensaje = 'ERROR: El Valor Esperado es 0.';
                 sugerencia = 'Revisa las entradas nominales, el c√°lculo result√≥ en cero, lo cual impide el an√°lisis porcentual.';
            } else {
                const diferencia = Math.abs(valorReal - valorEsperado);
                const porcentajeDiferencia = diferencia / valorEsperado;

                if (porcentajeDiferencia <= tolerancia) {
                    mensaje = `OPERACI√ìN NORMAL (Tolerancia ¬±${Math.round(tolerancia * 100)}%)`;
                    sugerencia = 'El equipo opera dentro de los par√°metros de dise√±o. Verifique causas mec√°nicas o de control si persiste el problema.';
                    claseDiagnostico = 'alerta-normal';
                } else if (valorReal > valorEsperado) {
                    claseDiagnostico = 'alerta-alto';
                    if (variable === 'I') {
                        mensaje = `ALARMA CR√çTICA: Corriente Real MUY ALTA (Sobreconsumo).`;
                        sugerencia = 'Causa Probable: **Cortocircuito** o **Carga en Paralelo** inesperada. **Acci√≥n**: Desconectar y verificar aislamiento. El aislamiento ha fallado, causando **R baja** (R‚Üì).';
                    } else if (variable === 'R') {
                        mensaje = `PRECAUCI√ìN: Resistencia Real MUY ALTA (Carga Deficiente).`;
                        sugerencia = 'Causa Probable: **Conexi√≥n Abierta Parcial** o **Falla en bobinado/filamento**. **Acci√≥n**: Inspeccionar terminales y contactos (R alta).';
                    } else if (variable === 'V') {
                        mensaje = `ALARMA: Voltaje Real MUY ALTO (Sobretensi√≥n).`;
                        sugerencia = 'Causa Probable: **Falla de regulaci√≥n de fuente** o variaci√≥n en l√≠nea principal. **Acci√≥n**: Verificar transformadores y reguladores. ¬°Riesgo de da√±o en equipos!';
                    }
                } else { // valorReal < valorEsperado
                    claseDiagnostico = 'alerta-bajo';
                    if (variable === 'I') {
                        mensaje = `PRECAUCI√ìN: Corriente Real MUY BAJA (Subconsumo).`;
                        sugerencia = 'Causa Probable: **Circuito Abierto Total/Parcial** (falla de continuidad). **Acci√≥n**: Revisar fusibles, contactores y cableado (R alta).';
                    } else if (variable === 'R') {
                        mensaje = `ALARMA: Resistencia Real MUY BAJA (Cortocircuito Potencial).`;
                        sugerencia = 'Causa Probable: **Cortocircuito** interno o reemplazo por componente de **menor valor** (R baja). **Acci√≥n**: Desenergizar y verificar la carga.';
                    } else if (variable === 'V') {
                        mensaje = `ADVERTENCIA: Voltaje Real MUY BAJO (Ca√≠da de Tensi√≥n).`;
                        sugerencia = 'Causa Probable: **Cableado subdimensionado** o **Fuente de alimentaci√≥n sobrecargada**. **Acci√≥n**: Medir la tensi√≥n en la fuente para descartar problemas de l√≠nea.';
                    }
                }
            }


            // 4. Mostrar Resultados
            resultadoEsperadoElement.textContent = valorEsperado.toFixed(2);
            areaDiagnosticoElement.className = `diagnostico ${claseDiagnostico}`;
            mensajeDiagnosticoElement.textContent = mensaje;
            sugerenciaDiagnosticoElement.textContent = sugerencia;
        }
    </script> 
</body>
</html>
