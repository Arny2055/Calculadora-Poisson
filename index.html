<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Station Master Ultra Pro - 10-Market Intelligence</title>
    <style>
        :root {
            --primary: #0f172a; --accent: #6366f1; --gold: #f59e0b;
            --success: #10b981; --danger: #ef4444; --slate: #64748b; --white: #ffffff;
        }
        body { font-family: 'Inter', system-ui, sans-serif; background: #f1f5f9; margin: 0; padding: 20px; color: #1e293b; }
        .container { max-width: 1400px; margin: auto; }
        .header { background: var(--primary); color: white; padding: 30px; border-radius: 20px; text-align: center; margin-bottom: 25px; border-bottom: 6px solid var(--gold); }
        .grid-inputs { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px; }
        textarea { width: 100%; height: 150px; border-radius: 12px; border: 2px solid #cbd5e1; padding: 15px; font-family: 'Consolas', monospace; font-size: 11px; resize: none; }
        .btn-main { width: 100%; padding: 20px; background: var(--accent); color: white; border: none; border-radius: 12px; font-size: 1.3rem; font-weight: 800; cursor: pointer; transition: 0.3s; margin-bottom: 30px; }
        .btn-main:hover { background: #4f46e5; transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(99, 102, 241, 0.3); }

        .dashboard { display: none; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 15px; }
        .card { background: var(--white); border-radius: 16px; padding: 20px; border: 1px solid #e2e8f0; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.05); }
        .card h3 { margin-top: 0; font-size: 0.85rem; text-transform: uppercase; color: var(--slate); border-bottom: 2px solid #f1f5f9; padding-bottom: 8px; letter-spacing: 1px; margin-bottom: 12px; }
        .stat { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #f8fafc; font-size: 0.9rem; }
        .val { font-weight: bold; color: var(--primary); }
        
        .chronicle-box { grid-column: 1 / -1; background: var(--white); border-left: 8px solid var(--gold); padding: 25px; border-radius: 16px; margin-top: 10px; }
        .chronicle-text { font-style: italic; color: #334155; line-height: 1.7; font-size: 1.05rem; }
        .highlight { background: #fef3c7; padding: 2px 5px; border-radius: 4px; font-weight: bold; font-style: normal; }
        .pick-tag { display: inline-block; padding: 5px 12px; border-radius: 20px; font-size: 0.8rem; font-weight: 700; margin-right: 8px; margin-top: 10px; }
        .tag-win { background: #dcfce7; color: #166534; }
    </style>
</head>
<body>

<div class="container">
    <div class="header">
        <h1>STATION MASTER ULTRA v5.0</h1>
        <p>An√°lisis de 10 Mercados: Desde H√°ndicaps hasta Probabilidades de Marcador</p>
    </div>

    <div class="grid-inputs">
        <textarea id="dataL" placeholder="DATOS LOCAL (Newcastle)"></textarea>
        <textarea id="dataV" placeholder="DATOS VISITANTE (Macarthur)"></textarea>
    </div>
    <button class="btn-main" onclick="analizarMercados()">PROCESAR AN√ÅLISIS GLOBAL</button>

    <div id="dashboard" class="dashboard">
        <div class="card">
            <h3>‚öñÔ∏è Resultado y Doble Oportunidad</h3>
            <div id="m-win"></div>
        </div>

        <div class="card">
            <h3>‚öΩ Goles (Over/Under)</h3>
            <div id="m-goles"></div>
        </div>

        <div class="card">
            <h3>üìâ H√°ndicap Asi√°tico y Europeo</h3>
            <div id="m-handicap"></div>
        </div>

        <div class="card">
            <h3>üéØ Especiales (DNB / BTTS / Par)</h3>
            <div id="m-spec"></div>
        </div>

        <div class="card">
            <h3>‚è±Ô∏è Medio Tiempo / Marcador</h3>
            <div id="m-score"></div>
        </div>

        <div class="card full-width chronicle-box">
            <h3>üìù Informe Cr√≠tico de Inteligencia</h3>
            <div id="text-chronicle" class="chronicle-text">Introduzca datos...</div>
            <div id="final-picks"></div>
        </div>
    </div>
</div>

<script>
function get(t, r, p=false) {
    const m = t.match(r);
    return m ? (p ? parseFloat(m[1])/100 : parseFloat(m[1])) : 0;
}

function row(l, v) { return `<div class="stat"><span>${l}</span><span class="val">${v}</span></div>`; }

function analizarMercados() {
    const l = document.getElementById('dataL').value;
    const v = document.getElementById('dataV').value;
    if(!l || !v) return;

    const D = {
        ln: l.match(/flag\s*\n\s*(.*)/)?.[1] || "Local",
        vn: v.match(/flag\s*\n\s*(.*)/)?.[1] || "Visitante",
        l_ppg: get(l, /PPG \(Home\):\s*([\d.]+)/),
        v_ppg: get(v, /PPG \(Away\):\s*([\d.]+)/),
        l_gf: get(l, /GF per match\s*([\d.]+)/),
        l_ga: get(l, /GA per match\s*([\d.]+)/),
        v_gf: get(v, /GF per match\s*([\d.]+)/),
        v_ga: get(v, /GA per match\s*([\d.]+)/),
        l_ht: get(l, /Leading at HT\s*(\d+)/),
        l_o25: get(l, /% over 2.5 goals\s*(\d+)%/, true),
        v_o25: get(v, /% over 2.5 goals\s*(\d+)%/, true),
        l_btts: get(l, /% both teams scored\s*(\d+)%/, true),
        v_btts: get(v, /% both teams scored\s*(\d+)%/, true),
        l_015: get(l, /0-15\s*GF\s*(\d+)/),
        v_7590: get(v, /76-90\s*GF\s*\d+\s*GA\s*(\d+)/)
    };

    document.getElementById('dashboard').style.display = 'grid';

    // 1. 1X2 & DOBLE OPORTUNIDAD
    let pL = (D.l_ppg / (D.l_ppg + D.v_ppg + 0.5)) * 100;
    let pV = (D.v_ppg / (D.l_ppg + D.v_ppg + 0.5)) * 100;
    let pE = 100 - pL - pV;
    document.getElementById('m-win').innerHTML = 
        row("1X2", `${pL.toFixed(0)}% | ${pE.toFixed(0)}% | ${pV.toFixed(0)}%`) +
        row("1X (Local o Empate)", (pL + pE).toFixed(1) + "%") +
        row("X2 (Visitante o Empate)", (pV + pE).toFixed(1) + "%");

    // 2. OVER/UNDER
    let xG = ((D.l_gf + D.v_ga)/2) + ((D.v_gf + D.l_ga)/2);
    document.getElementById('m-goles').innerHTML = 
        row("Proyecci√≥n Goles (xG)", xG.toFixed(2)) +
        row("Over 1.5", (xG > 1.5 ? 85 : 60) + "%") +
        row("Over 2.5", ((D.l_o25 + D.v_o25)/2*100).toFixed(1) + "%");

    // 3. HANDICAPS
    document.getElementById('m-handicap').innerHTML = 
        row("Asi√°tico (Estimado)", pL > pV ? "-0.5 Local" : "+0.5 Visita") +
        row("Europeo (H-1)", pL > 50 ? "Local" : "No recomendado");

    // 4. ESPECIALES
    let btts = ((D.l_btts + D.v_btts)/2*100).toFixed(1);
    document.getElementById('m-spec').innerHTML = 
        row("Ambos Anotan (BTTS)", btts + "%") +
        row("Apuesta sin Empate (DNB)", pL > pV ? "1 (Local)" : "2 (Visita)") +
        row("Par / Impar", Math.round(xG) % 2 === 0 ? "Par (Tendencia)" : "Impar (Tendencia)");

    // 5. HT/FT & MARCADOR
    const mLocal = Math.round((D.l_gf + D.v_ga)/2);
    const mVisit = Math.round((D.v_gf + D.l_ga)/2);
    document.getElementById('m-score').innerHTML = 
        row("Medio Tiempo / Final", D.l_ht > 3 ? "1 / 1" : "X / 1") +
        row("Marcador Correcto", `${mLocal} - ${mVisit}`);

    // CR√çTICA
    let cronica = `El duelo entre <span class="highlight">${D.ln}</span> y <span class="highlight">${D.vn}</span> se define por la asimetr√≠a temporal. `;
    cronica += `Mientras el local golpea con fuerza en los primeros 15 min (${D.l_015} goles), el visitante sufre un colapso sistem√°tico en el tramo final (${D.v_7590} goles concedidos). `;
    cronica += `Desde la perspectiva de los h√°ndicaps, el valor reside en el <span class="highlight">DNB Local</span>, protegiendo la inversi√≥n ante un empate que la estad√≠stica sit√∫a en el ${pE.toFixed(0)}%. `;
    cronica += `La tendencia de goles (xG ${xG.toFixed(2)}) sugiere un partido abierto, donde el BTTS tiene una probabilidad s√≥lida del ${btts}%.`;
    
    document.getElementById('text-chronicle').innerHTML = cronica;
    document.getElementById('final-picks').innerHTML = `
        <span class="pick-tag tag-win">Pick: 1X & Over 1.5</span>
        <span class="pick-tag tag-win">Handicap: L +0.0 (DNB)</span>
        <span class="pick-tag tag-win">Marcador: ${mLocal}-${mVisit}</span>
    `;
}
</script>

</body>
</html>
