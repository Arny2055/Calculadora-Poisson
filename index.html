<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de Kelly, EV y Overround</title>
    <style>
        /* Estilos CSS (similares a los anteriores, con ajustes para Kelly) */
        body {
            font-family: 'Arial', sans-serif;
            background-color: #121212;
            color: #E0E0E0;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
        }

        .calculator-container {
            background-color: #1E1E1E;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
            width: 100%;
            max-width: 450px; /* Un poco m치s ancho para m치s resultados */
            border: 1px solid #333;
        }

        h1 {
            color: #00FF99;
            text-align: center;
            margin-bottom: 25px;
            font-size: 1.8em;
            border-bottom: 2px solid #00FF99;
            padding-bottom: 10px;
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: bold;
            color: #B0B0B0;
        }

        .input-group input[type="number"] {
            width: calc(100% - 20px);
            padding: 10px;
            border: 1px solid #333;
            border-radius: 8px;
            background-color: #2D2D2D;
            color: #E0E0E0;
            font-size: 1em;
            transition: border-color 0.3s;
        }

        .input-group input[type="number"]:focus {
            border-color: #00FF99;
            outline: none;
        }

        .button-calculate {
            width: 100%;
            padding: 12px;
            background-color: #00FF99;
            color: #121212;
            border: none;
            border-radius: 8px;
            font-size: 1.1em;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.3s, transform 0.1s;
        }

        .button-calculate:hover {
            background-color: #00E68A;
        }

        .results {
            margin-top: 25px;
            padding-top: 20px;
            border-top: 1px solid #333;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            font-size: 1.1em;
            padding: 5px 0;
            border-bottom: 1px dotted #333;
        }
        
        /* Estilo para los resultados clave de Kelly */
        .kelly-output {
            background-color: #00FF9920; /* Fondo ligero para destacar */
            padding: 8px;
            border-radius: 5px;
            margin-top: 10px;
        }

        .result-item span:first-child {
            font-weight: bold;
            color: #B0B0B0;
        }

        /* Colores din치micos */
        .ev-positive {
            color: #4CAF50; /* Verde para positivo */
            font-weight: bold;
        }

        .ev-negative {
            color: #F44336; /* Rojo para negativo */
            font-weight: bold;
        }
        
        .kelly-fraction {
            color: #FFEB3B; /* Amarillo para la Fracci칩n de Kelly */
            font-weight: bold;
        }
    </style>
</head>
<body>

    <div class="calculator-container">
        <h1>游늳 Calculadora Kelly, EV & Valor</h1>
        
        <div class="input-group">
            <label for="bankroll">Bankroll Total ($)</label>
            <input type="number" id="bankroll" placeholder="Ej: 1000" min="1" step="1" value="1000"> 
        </div>

        <div class="input-group">
            <label for="probabilidad">Probabilidad Estimada por Ti (%)</label>
            <input type="number" id="probabilidad" placeholder="Ej: 55" min="0" max="100" step="0.01">
        </div>

        <div class="input-group">
            <label for="cuota">Cuota de la Bookie (Decimal)</label>
            <input type="number" id="cuota" placeholder="Ej: 1.95" min="1.01" step="0.01">
        </div>

        <button class="button-calculate" onclick="calcular()">
            Calcular
        </button>

        <div class="results">
            <h2>Resultados Clave</h2>
            
            <div class="result-item">
                <span>Valor Esperado (EV):</span>
                <span id="evResult">-</span>
            </div>
            
            <div class="result-item">
                <span>Valor de la Apuesta (Tu P vs Bookie P):</span>
                <span id="valorResult">-</span>
            </div>
            
            <div class="kelly-output">
                <h3>Criterio de Kelly (M치x. 5%)</h3>
                <div class="result-item">
                    <span>Fracci칩n de Kelly (f*):</span>
                    <span id="kellyFraction" class="kelly-fraction">-</span>
                </div>
                <div class="result-item">
                    <span>Cantidad a Apostar 칍ptima:</span>
                    <span id="kellyBetAmount" class="ev-positive">-</span>
                </div>
            </div>
            
            <div class="result-item" style="margin-top: 20px;">
                <span>Probabilidad Impl칤cita de la Bookie:</span>
                <span id="probabilidadBookie">-</span>
            </div>
        </div>
    </div>

    <script>
        function calcular() {
            // 1. Obtener valores de los campos
            const bankroll = parseFloat(document.getElementById('bankroll').value);
            const probabilidadUsuario = parseFloat(document.getElementById('probabilidad').value) / 100;
            const cuota = parseFloat(document.getElementById('cuota').value);
            
            // Elementos de salida
            const probBookieDisplay = document.getElementById('probabilidadBookie');
            const evResultDisplay = document.getElementById('evResult');
            const valorResultDisplay = document.getElementById('valorResult');
            const kellyFractionDisplay = document.getElementById('kellyFraction');
            const kellyBetAmountDisplay = document.getElementById('kellyBetAmount');

            // 2. Validaci칩n de entradas
            if (isNaN(bankroll) || isNaN(probabilidadUsuario) || isNaN(cuota) || bankroll <= 0 || probabilidadUsuario <= 0 || probabilidadUsuario > 1 || cuota <= 1.0) {
                alert('Por favor, ingresa un Bankroll v치lido, Probabilidad (1-100) y Cuota (>1.0).');
                
                // Limpiar y poner error
                const errorText = '춰Error!';
                evResultDisplay.textContent = errorText;
                evResultDisplay.className = 'ev-negative';
                probBookieDisplay.textContent = '-';
                valorResultDisplay.textContent = '-';
                kellyFractionDisplay.textContent = '-';
                kellyBetAmountDisplay.textContent = errorText;
                kellyBetAmountDisplay.className = 'ev-negative';
                return;
            }

            // --- C츼LCULO DE VALOR ESPERADO (EV) ---
            const gananciaNetaUnitaria = (cuota - 1); 
            const probabilidadPerder = 1 - probabilidadUsuario;
            
            const ev = (probabilidadUsuario * gananciaNetaUnitaria) - (probabilidadPerder * 1);
            
            // --- C츼LCULO DE PROBABILIDAD IMPL칈CITA Y VALOR ---
            const probabilidadBookieDecimal = 1 / cuota;
            const probabilidadBookiePorcentaje = probabilidadBookieDecimal * 100;
            
            // Valor (Diferencia porcentual de probabilidades)
            const valorPorcentaje = ((probabilidadUsuario - probabilidadBookieDecimal) * 100).toFixed(2);
            
            // --- C츼LCULO DE CRITERIO DE KELLY (f*) ---
            // F칩rmula: f* = [P * Cuota - 1] / (Cuota - 1)
            let kellyFraction = (probabilidadUsuario * cuota - 1) / gananciaNetaUnitaria;
            
            // 救넖잺 APLICAR L칈MITE DEL 5% Y CERO PARA EV NEGATIVO
            if (kellyFraction <= 0) {
                kellyFraction = 0;
            } else {
                // Aplicar el m치ximo del 5% (0.05)
                kellyFraction = Math.min(kellyFraction, 0.05);
            }
            
            // Cantidad a Apostar seg칰n Kelly: f* * Bankroll
            const kellyBetAmount = kellyFraction * bankroll;

            // 3. Mostrar resultados
            
            // EV
            let evClass = 'ev-neutral';
            if (ev > 0.001) {
                evClass = 'ev-positive';
            } else if (ev < -0.001) {
                evClass = 'ev-negative';
            }

            // EV se muestra como porcentaje de la apuesta.
            evResultDisplay.textContent = `${(ev * 100).toFixed(2)} %`;
            evResultDisplay.className = evClass;
            
            // Probabilidad Impl칤cita
            probBookieDisplay.textContent = `${probabilidadBookiePorcentaje.toFixed(2)} %`;
            
            // Valor
            valorResultDisplay.textContent = `${valorPorcentaje} %`;
            valorResultDisplay.className = (parseFloat(valorPorcentaje) > 0) ? 'ev-positive' : 'ev-negative';

            // Kelly
            kellyFractionDisplay.textContent = `${(kellyFraction * 100).toFixed(2)} %`;
            
            if (kellyFraction > 0) {
                kellyBetAmountDisplay.textContent = `${kellyBetAmount.toFixed(2)} $`;
                kellyBetAmountDisplay.className = 'ev-positive';
            } else {
                kellyBetAmountDisplay.textContent = '0.00 $ (EV Negativo)';
                kellyBetAmountDisplay.className = 'ev-negative';
            }
        }
    </script>
</body>
</html>
