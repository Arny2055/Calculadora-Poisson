<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mis Apuestas Activas</title>
    <style>
        :root { --bg: #0f172a; --card: #1e293b; --text: #f8fafc; --success: #10b981; --danger: #ef4444; --gold: #fbbf24; }
        body { font-family: sans-serif; background: var(--bg); color: var(--text); padding: 15px; margin: 0; }
        .container { max-width: 600px; margin: auto; }
        .bet-card { background: var(--card); border-radius: 12px; padding: 15px; margin-bottom: 10px; border-left: 5px solid var(--gold); }
        .bet-header { display: flex; justify-content: space-between; font-size: 12px; margin-bottom: 5px; opacity: 0.8; }
        .bet-main { font-size: 16px; font-weight: bold; margin-bottom: 10px; }
        .bet-footer { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .btn-win { background: var(--success); color: white; border: none; padding: 10px; border-radius: 6px; font-weight: bold; }
        .btn-loss { background: var(--danger); color: white; border: none; padding: 10px; border-radius: 6px; font-weight: bold; }
        .history-item { opacity: 0.6; padding: 8px; border-bottom: 1px solid #334155; display: flex; justify-content: space-between; font-size: 13px; }
        .btn-nav { display: block; text-align: center; padding: 10px; color: var(--gold); text-decoration: none; margin-bottom: 20px; border: 1px solid var(--gold); border-radius: 8px; }
    </style>
</head>
<body>
<div class="container">
    <a href="estrategia.html" class="btn-nav">‚Üê VOLVER AL PORTAFOLIO</a>
    <h3>üéØ Apuestas Pendientes</h3>
    <div id="pendingBets"></div>
    <hr style="opacity:0.1; margin:20px 0;">
    <h3>üìú Historial Reciente</h3>
    <div id="historyBets"></div>
    <button onclick="clearHistory()" style="width:100%; margin-top:20px; background:transparent; color:gray; border:none; font-size:10px;">BORRAR HISTORIAL</button>
</div>
<script>
function loadBets() {
    const bets = JSON.parse(localStorage.getItem('activeBets') || "[]");
    const pendingDiv = document.getElementById('pendingBets');
    const historyDiv = document.getElementById('historyBets');
    
    const pending = bets.filter(b => b.estado === 'PENDIENTE');
    const history = bets.filter(b => b.estado !== 'PENDIENTE').reverse();

    pendingDiv.innerHTML = pending.map((b, i) => `
        <div class="bet-card">
            <div class="bet-header"><span>${b.estrategia}</span> <span>${b.fechaColocada}</span></div>
            <div class="bet-main">${b.equipo} @${b.cuotaFinal} <small>(Stake ${b.stake})</small></div>
            <div class="bet-footer">
                <button class="btn-win" onclick="resolveBet('${b.fechaColocada}', 'WIN')">GANADA</button>
                <button class="btn-loss" onclick="resolveBet('${b.fechaColocada}', 'LOSS')">PERDIDA</button>
            </div>
        </div>
    `).join('') || "<p style='opacity:0.5'>No hay apuestas activas.</p>";

    historyDiv.innerHTML = history.slice(0, 10).map(b => `
        <div class="history-item">
            <span>${b.equipo} (@${b.cuotaFinal})</span>
            <span style="color:${b.estado==='WIN'?'var(--success)':'var(--danger)'}">${b.estado}</span>
        </div>
    `).join('');
}

function resolveBet(id, result) {
    let bets = JSON.parse(localStorage.getItem('activeBets') || "[]");
    const idx = bets.findIndex(b => b.fechaColocada === id);
    if(idx !== -1) {
        bets[idx].estado = result;
        localStorage.setItem('activeBets', JSON.stringify(bets));
        loadBets();
    }
}
function clearHistory() { if(confirm('¬øLimpiar historial?')) { 
    let bets = JSON.parse(localStorage.getItem('activeBets') || "[]");
    bets = bets.filter(b => b.estado === 'PENDIENTE');
    localStorage.setItem('activeBets', JSON.stringify(bets));
    loadBets();
}}
window.onload = loadBets;
</script>
</body>
</html>
